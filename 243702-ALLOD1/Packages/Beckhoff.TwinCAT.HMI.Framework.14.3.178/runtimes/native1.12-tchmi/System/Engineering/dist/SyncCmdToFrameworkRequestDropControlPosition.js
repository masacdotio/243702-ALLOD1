import{SyncCmdToFramework,registerCommand}from"./SyncCmdToFramework.js";import{SyncCmdToCreatorDropControlPosition}from"./SyncCmdToCreatorDropControlPosition.js";import{hierarchyManager}from"./DesignerModeMasterHierarchyMngr.js";TCHMI_DESIGNER||TcHmi.Log.errorEx(`Internal error: The file "${import.meta.url}" is restricted to use within the designer.`);export class SyncCmdToFrameworkRequestDropControlPosition extends SyncCmdToFramework{constructor(cmd){super(cmd)}run(){if(!TCHMI_DESIGNER)return;const preparedTargetPartial=tchmi_path(this.__cmd.targetPartial);if(preparedTargetPartial!==TCHMI_TARGET_PARTIAL)return;if(void 0===this.__cmd.type||null===this.__cmd.type)return void(this.__result=TcHmi.Errors.E_PARAMETER_INVALID);const dropConfig=hierarchyManager.getContainerFromPoint({left:this.__cmd.position.left+window.scrollX,top:this.__cmd.position.top+window.scrollY});if(!dropConfig)return void(this.__result=TcHmi.Errors.ERROR);let command={name:"DropControlPosition",controls:[{piggyBack:this.__cmd.piggyBack,targetParentControl:dropConfig.tco.getId(),type:this.__cmd.type,position:{centerX:dropConfig.mousePosXinTarget,centerY:dropConfig.mousePosYinTarget}}],targetPartial:preparedTargetPartial,frameworkType:TCHMI_DESIGNER?"Designer":"LiveView",replyTo:null};null===dropConfig.rowIndex||null===dropConfig.columnIndex||0===dropConfig.rowIndex&&0===dropConfig.columnIndex||(command.controls[0].attributes=[{name:"data-tchmi-grid-row-index",value:dropConfig.rowIndex},{name:"data-tchmi-grid-column-index",value:dropConfig.columnIndex}]),new SyncCmdToCreatorDropControlPosition(command).send()}}SyncCmdToFrameworkRequestDropControlPosition.supportedCommand="RequestDropControlPosition",registerCommand(SyncCmdToFrameworkRequestDropControlPosition);